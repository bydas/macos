{% liquid
  # Cliente verificado para poder ver preços e adicionar ao carrinho
  if customer == nil or customer and customer.tags contains "nao-verificado"
    assign verified_customer = false
  else
    assign verified_customer = true
  endif

  # ----- Preço 1 vs Preço 2 -----
  if verified_customer and customer.tags contains "preco2"
    assign customer_has_preco2 = true
  else
    assign customer_has_preco2 = false
  endif

  # Decalarada inicialmente antes de qualquer verificação para ter um valor atribuído caso um produto não tenha variante
  assign selected_variant_for_customer = product.selected_or_first_available_variant

  # Verificar em que posição do array de variantes está "Tabela"
  assign tabela_index = nil

  for option in product.options_with_values
    if option.name == 'Tabela'
      assign tabela_index = forloop.index0
    endif
  endfor

  # Atribuir variante ao cliente
  if tabela_index != nil
    for prod_variant in product.variants
      assign tabela_value = prod_variant.options[tabela_index]

      if customer_has_preco2 and tabela_value == "2"
      
        assign selected_variant_for_customer = prod_variant
        break

      elsif customer_has_preco2 == false and tabela_value == "1"

        assign selected_variant_for_customer = prod_variant
        break

      endif
    endfor
  endif
%}